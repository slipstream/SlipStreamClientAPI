<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><title>sixsq.slipstream.client.api.run documentation</title></head><body><header><section class="title"><h1><a href="index.html">SlipStream Client API Api Documentation</a></h1></section><small>Version: 3.1-SNAPSHOT</small></header><section class="container"><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sixsq</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>slipstream</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></div></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></div></li><li class="depth-5 branch"><a href="sixsq.slipstream.client.api.cimi.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cimi</span></div></a></li><li class="depth-5"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lib</span></div></div></li><li class="depth-6"><a href="sixsq.slipstream.client.api.lib.run.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>run</span></div></a></li><li class="depth-5 branch current"><a href="sixsq.slipstream.client.api.run.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>run</span></div></a></li><li class="depth-5"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></div></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>context</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.http.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.http-async.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http-async</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.path.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>path</span></div></a></li><li class="depth-6"><a href="sixsq.slipstream.client.api.utils.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><section class="namespace-docs" id="content"><h2 class="anchor" id="top">sixsq.slipstream.client.api.run</h2><div class="doc"><div class="markdown"><h1>Purpose</h1><p>The <code>run</code> namespace contains functions for interacting with SlipStream runs.</p><p>It allows users to</p>
<ul>
  <li>Scale the components of the running application up and down,</li>
  <li>Query the state of the run,</li>
  <li>Query and set parameters of the application components and their instances,</li>
  <li>Query parameters from global namespace (<code>ss:</code>), and</li>
  <li>Terminate the run.</li>
</ul><p>Timeouts and intervals are in seconds.</p><h1>SlipStraem run termininology</h1><p>There are three types of parameters on a run</p>
<ul>
  <li>Global parameter - <code>ss:tags</code></li>
  <li>Application component parameter - <code>webapp:ids</code></li>
  <li>Application component instance parameter - <code>webapp.1:hostname</code></li>
</ul><p>where</p>
<ul>
  <li><code>ss</code> is the global namespace of the run,</li>
  <li><code>webapp</code> is the name of the application component, which is referred to as <code>comp</code>  in the API,</li>
  <li><code>webapp.1</code> is the name of the instance <code>1</code> of the application component <code>webapp</code>.</li>
</ul><h1>Usage and examples</h1><p>The namespace can be bootstrapped either from <code>slipstream.context</code> file (in .ini format) or by explicitly providing the configuration to <code>contextualize!</code>.</p><p>In the case of <code>slipstream.context</code>, the following structure and parameters are assumed</p>
<pre><code>[contextualization]

# SlipStream endpoint.
serviceurl = https://nuv.la

# SlipStream user credentials
username = foo
password = bar

# preferred over username and password
cookie = key=val; Path:/

# run UUID
diid = 123
</code></pre><p>This file is usually available on SlipStream managed VMs and is used by orchestrator and node executors.</p><p>First call to any of the API functions searches and loads the contextualisation file. All successive calls use the locally bound configuration.</p><p>Explicitly calling <code>contextualize!</code> w/o parameters reload the contextualization and updates the configuration of the namespace.</p><p><code>contextualize!</code> can be called with a context map</p>
<pre><code>{:serviceurl &quot;https://nuv.la&quot;

 ;; run UUID
 :diid &quot;123&quot;

 :cookie &quot;key=val; Path:/&quot;

 :username &quot;foo&quot;
 :password &quot;bar&quot;
 }
</code></pre><p>where either <code>:cookie</code> or <code>:username</code> and <code>:password</code> are mandatory.</p><h2>Examples</h2><p>Implicit bootstrap &ndash; <code>slipstream.context</code> with the correct parameters should be in the search path.</p>
<pre><code>(require &#39;[com.sixsq.slipstream.clj-client.run-wrap :as r])

(r/get-run-info)
</code></pre><p>Manually define configuration and contextualize the namespace.</p>
<pre><code>(require &#39;[com.sixsq.slipstream.clj-client.run-wrap :as r])

(def conf {:serviceurl &quot;https://nuv.la&quot;
          :diid &quot;123-456&quot;
          :username &quot;foo&quot;
          :password &quot;bar&quot;})
(rw/contextualize! conf)

(r/get-run-info)
</code></pre></div></div><div class="public anchor" id="var-*context*"><h3><a href="#var-*context*">*context*</a></h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-aborted.3F"><h3><a href="#var-aborted.3F">aborted?</a></h3><div class="usage"><code>(aborted?)</code></div><div class="doc"><div class="markdown"><p>Check if run is in &lsquo;Aborted&rsquo; state.</p></div></div></div><div class="public anchor" id="var-action-scale-down-at"><h3><a href="#var-action-scale-down-at">action-scale-down-at</a></h3><div class="usage"><code>(action-scale-down-at comp ids &amp; [&amp; {:keys [timeout], :or {timeout wait-timeout-default}}])</code></div><div class="doc"><div class="markdown"><p>Scale down application component &lsquo;comp&rsquo; by terminating the component instances identified by IDs in &lsquo;ids&rsquo;. Wait for the completion of the action.</p></div></div></div><div class="public anchor" id="var-action-scale-down-by"><h3><a href="#var-action-scale-down-by">action-scale-down-by</a></h3><div class="usage"><code>(action-scale-down-by comp n &amp; [&amp; {:keys [timeout], :or {timeout wait-timeout-default}}])</code></div><div class="doc"><div class="markdown"><p>Scale down application component &lsquo;comp&rsquo; by &lsquo;n&rsquo; instances. Wait for the completion of the action.</p></div></div></div><div class="public anchor" id="var-action-scale-up"><h3><a href="#var-action-scale-up">action-scale-up</a></h3><div class="usage"><code>(action-scale-up comp n &amp; [&amp; {:keys [params timeout], :or {params {}, timeout wait-timeout-default}}])</code></div><div class="doc"><div class="markdown"><p>Scale application component &lsquo;comp&rsquo; by &lsquo;n&rsquo; instances up. Wait for the completion of the action. Optionally provide map of parameters as &lsquo;params&rsquo;.</p></div></div></div><div class="public anchor" id="var-action-success.3F"><h3><a href="#var-action-success.3F">action-success?</a></h3><div class="usage"><code>(action-success? result)</code></div><div class="doc"><div class="markdown"><p>Given the &lsquo;result&rsquo; returned by an action, check if it was successfull.</p></div></div></div><div class="public anchor" id="var-can-scale.3F"><h3><a href="#var-can-scale.3F">can-scale?</a></h3><div class="usage"><code>(can-scale?)</code></div><div class="doc"><div class="markdown"><p>Check if it&rsquo;s possible to scale the run.</p></div></div></div><div class="public anchor" id="var-cancel-abort"><h3><a href="#var-cancel-abort">cancel-abort</a></h3><div class="usage"><code>(cancel-abort)</code></div><div class="doc"><div class="markdown"><p>Cancel abort on the run.</p></div></div></div><div class="public anchor" id="var-contextualize.21"><h3><a href="#var-contextualize.21">contextualize!</a></h3><div class="usage"><code>(contextualize!)</code><code>(contextualize! context)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-get-abort"><h3><a href="#var-get-abort">get-abort</a></h3><div class="usage"><code>(get-abort)</code></div><div class="doc"><div class="markdown"><p>Get abort message.</p></div></div></div><div class="public anchor" id="var-get-comp-ids"><h3><a href="#var-get-comp-ids">get-comp-ids</a></h3><div class="usage"><code>(get-comp-ids comp)</code></div><div class="doc"><div class="markdown"><p>Get list of instance IDs of application component &lsquo;comp&rsquo;.</p></div></div></div><div class="public anchor" id="var-get-multiplicity"><h3><a href="#var-get-multiplicity">get-multiplicity</a></h3><div class="usage"><code>(get-multiplicity comp)</code></div><div class="doc"><div class="markdown"><p>Get multiplicity of application component &lsquo;comp&rsquo;.</p></div></div></div><div class="public anchor" id="var-get-param"><h3><a href="#var-get-param">get-param</a></h3><div class="usage"><code>(get-param comp id param)</code></div><div class="doc"><div class="markdown"><p>Get parameter &lsquo;param&rsquo; of application component instance &lsquo;comp.id&rsquo; as &lsquo;comp.id:param&rsquo;. When &lsquo;id&rsquo; is nil, gets parameter of the application component as &lsquo;comp:param&rsquo;.</p></div></div></div><div class="public anchor" id="var-get-run-info"><h3><a href="#var-get-run-info">get-run-info</a></h3><div class="usage"><code>(get-run-info)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-get-scale-state"><h3><a href="#var-get-scale-state">get-scale-state</a></h3><div class="usage"><code>(get-scale-state comp id)</code></div><div class="doc"><div class="markdown"><p>Get scale state of the component instance.</p></div></div></div><div class="public anchor" id="var-get-state"><h3><a href="#var-get-state">get-state</a></h3><div class="usage"><code>(get-state)</code></div><div class="doc"><div class="markdown"><p>Get state of the run.</p></div></div></div><div class="public anchor" id="var-run-uuid"><h3><a href="#var-run-uuid">run-uuid</a></h3><div class="usage"><code>(run-uuid)</code></div><div class="doc"><div class="markdown"></div></div></div><div class="public anchor" id="var-scalable.3F"><h3><a href="#var-scalable.3F">scalable?</a></h3><div class="usage"><code>(scalable?)</code></div><div class="doc"><div class="markdown"><p>Check if run is scalable.</p></div></div></div><div class="public anchor" id="var-scale-down"><h3><a href="#var-scale-down">scale-down</a></h3><div class="usage"><code>(scale-down comp ids)</code></div><div class="doc"><div class="markdown"><p>Scale down application component &lsquo;comp&rsquo; by terminating instances defined by &lsquo;ids&rsquo; vector.</p></div></div></div><div class="public anchor" id="var-scale-up"><h3><a href="#var-scale-up">scale-up</a></h3><div class="usage"><code>(scale-up comp n)</code><code>(scale-up comp n params)</code></div><div class="doc"><div class="markdown"><p>Scale up application component &lsquo;comp&rsquo; by &lsquo;n&rsquo; instances. Allow to set parameters from &lsquo;params&rsquo; map on the new component instances. Returns list of added component instance names qualified with IDs.</p></div></div></div><div class="public anchor" id="var-set-param"><h3><a href="#var-set-param">set-param</a></h3><div class="usage"><code>(set-param comp id param value)</code></div><div class="doc"><div class="markdown"><p>Set parameter &lsquo;param&rsquo; to &lsquo;value&rsquo; on application component instance &lsquo;comp.id&rsquo;.</p></div></div></div><div class="public anchor" id="var-set-params"><h3><a href="#var-set-params">set-params</a></h3><div class="usage"><code>(set-params comp id params)</code></div><div class="doc"><div class="markdown"><p>Given a map of parameters &lsquo;params&rsquo;, set them on application component instance &lsquo;comp.id&rsquo;.</p></div></div></div><div class="public anchor" id="var-terminate"><h3><a href="#var-terminate">terminate</a></h3><div class="usage"><code>(terminate)</code></div><div class="doc"><div class="markdown"><p>Terminate the run.</p></div></div></div><div class="public anchor" id="var-wait-ready"><h3><a href="#var-wait-ready">wait-ready</a></h3><div class="usage"><code>(wait-ready)</code><code>(wait-ready timeout)</code></div><div class="doc"><div class="markdown"><p>Waits for Ready state on the run. Returns true on success.</p></div></div></div><div class="public anchor" id="var-wait-timeout-default"><h3><a href="#var-wait-timeout-default">wait-timeout-default</a></h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div></div></section></section></body></html>