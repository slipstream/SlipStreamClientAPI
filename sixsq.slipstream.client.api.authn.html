<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>sixsq.slipstream.client.api.authn documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">com.sixsq.slipstream/SlipStreamClientAPI-jar</span> <span class="project-version">3.17-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="cimi.html"><div class="inner"><span>CIMI API</span></div></a></li><li class="depth-1 "><a href="legacy.html"><div class="inner"><span>Legacy REST API</span></div></a></li><li class="depth-1 "><a href="legal.html"><div class="inner"><span>Legal Information</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sixsq</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>slipstream</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></div></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></div></li><li class="depth-5 branch current"><a href="sixsq.slipstream.client.api.authn.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>authn</span></div></a></li><li class="depth-5"><a href="sixsq.slipstream.client.api.cimi.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cimi</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.cimi.async.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>async</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.cimi.impl-async.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl-async</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.cimi.sync.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sync</span></div></a></li><li class="depth-6"><a href="sixsq.slipstream.client.api.cimi.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li><li class="depth-5"><div class="no-link"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.impl.crud.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>crud</span></div></a></li><li class="depth-6"><a href="sixsq.slipstream.client.api.impl.run.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>run</span></div></a></li><li class="depth-5"><div class="no-link"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>lib</span></div></div></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.lib.app.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>app</span></div></a></li><li class="depth-6"><a href="sixsq.slipstream.client.api.lib.run.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>run</span></div></a></li><li class="depth-5 branch"><a href="sixsq.slipstream.client.api.run.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>run</span></div></a></li><li class="depth-5"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></div></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>context</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.error.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>error</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.http-async.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http-async</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.http-sync.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http-sync</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.http-utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http-utils</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.path.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>path</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li><li class="depth-6"><a href="sixsq.slipstream.client.api.utils.wait.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>wait</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-*context*"><div class="inner"><span>*context*</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-default-context"><div class="inner"><span>default-context</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-default-login-url"><div class="inner"><span>default-login-url</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-default-url"><div class="inner"><span>default-url</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-endpoint-from-url"><div class="inner"><span>endpoint-from-url</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-extract-response"><div class="inner"><span>extract-response</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-login"><div class="inner"><span>login</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-login.21"><div class="inner"><span>login!</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-login-async"><div class="inner"><span>login-async</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-login-async-with-status"><div class="inner"><span>login-async-with-status</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-login-resource"><div class="inner"><span>login-resource</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-logout-async-with-status"><div class="inner"><span>logout-async-with-status</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-result-tuple"><div class="inner"><span>result-tuple</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-select-context"><div class="inner"><span>select-context</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-set-context.21"><div class="inner"><span>set-context!</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-to-login-url"><div class="inner"><span>to-login-url</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-with-context"><div class="inner"><span>with-context</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">sixsq.slipstream.client.api.authn</h1><div class="doc"><div class="markdown"><p>Provides a utility to log into the SlipStream server and to recover an access token. No logout function is provided as the access can be removed by just destroying the token.</p>
<p>The library API functions in namespaces under <strong>sixsq.slipstream.client.api.lib</strong> use dynamic context defined in this namespace. To bootstrap the API with the context use <a href="sixsq.slipstream.client.api.authn.html#var-login.21">login!</a>. Each time when called, it alters the root of the context with the new authentication token obtained after performing basic authn with the username/password provided to <a href="sixsq.slipstream.client.api.authn.html#var-login.21">login!</a>.</p>
<p><code>(with-context new-context (api-function ...))</code> can be used to rebind the global context to the new provided one for the time of the invocation of a specific API function. The new context can, for example, be obtained by</p>
<pre><code>{:serviceurl "https://my.slipstream"
 :cookie (login username password)}
</code></pre>
<p>Full example</p>
<pre><code>(require '[sixsq.slipstream.client.api.authn :as a])
(require '[sixsq.slipstream.client.api.lib.app :as p])
(require '[sixsq.slipstream.client.api.lib.run :as r])

(def my-slipstream
  {:serviceurl "https://my.slipstream"
   :cookie (a/login username password)}

(def run-uuid
  (last
    (clojure.string/split
      (with-context my-slipstream (p/deploy "my/app")))))

(with-context my-slipstream
  (r/get-run-info run-uuid))
</code></pre>
<p>To contact server in an insecure mode (i.e. w/o checking the authenticity of the remote server) before calling login functions, re-set the root of the authentication context with</p>
<pre><code>(require '[sixsq.slipstream.client.api.authn :as a])

(a/set-context! {:insecure? true})
(a/login username password)
</code></pre>
<p>or wrap the API call for the local rebinding of the authentication context as follows</p>
<pre><code>(a/with-context {:insecure? true}
  (a/login! username password))
</code></pre></div></div><div class="public anchor" id="var-*context*"><h3>*context*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L77">view source</a></div></div><div class="public anchor" id="var-default-context"><h3>default-context</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L74">view source</a></div></div><div class="public anchor" id="var-default-login-url"><h3>default-login-url</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L70">view source</a></div></div><div class="public anchor" id="var-default-url"><h3>default-url</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L62">view source</a></div></div><div class="public anchor" id="var-endpoint-from-url"><h3>endpoint-from-url</h3><div class="usage"><code>(endpoint-from-url url)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L180">view source</a></div></div><div class="public anchor" id="var-extract-response"><h3>extract-response</h3><div class="usage"><code>(extract-response result)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L101">view source</a></div></div><div class="public anchor" id="var-login"><h3>login</h3><div class="usage"><code>(login username password)</code><code>(login username password login-url)</code></div><div class="doc"><div class="markdown"><p>Synchronous login to the server. Directly returns the access token. Not available in clojurescript.</p></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L171">view source</a></div></div><div class="public anchor" id="var-login.21"><h3>login!</h3><div class="usage"><code>(login! username password)</code><code>(login! username password login-url)</code></div><div class="doc"><div class="markdown"><p>Synchronous login to the server. Alters the root of the global dynamic authentication context used in the namespaces under <strong>sixsq.slipstream.client.api.lib</strong> to interact with the service. Returns the access token. Not available in clojurescript.</p></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L188">view source</a></div></div><div class="public anchor" id="var-login-async"><h3>login-async</h3><div class="usage"><code>(login-async username password)</code><code>(login-async username password login-url)</code></div><div class="doc"><div class="markdown"><p>Uses the given username and password to log into the SlipStream server.</p>
<p>This method returns a channel that will contain the results as a tuple of the status and token (cookie). Depending on the underlying HTTP client, the token may be nil even when the login request succeeded.</p>
<p>If called without an explicit login-url, then the default on Nuvla is used.</p>
<p><strong>FIXME</strong>: Ideally the login-url should be discovered from the cloud entry point.</p></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L145">view source</a></div></div><div class="public anchor" id="var-login-async-with-status"><h3>login-async-with-status</h3><div class="usage"><code>(login-async-with-status username password)</code><code>(login-async-with-status username password login-url)</code></div><div class="doc"><div class="markdown"><p>Uses the given username and password to log into the SlipStream server.</p>
<p>This method returns a channel that will contain the results as a map with the keys :login-status and :token. Depending on the underlying HTTP client, the token may be nil even when the login request succeeded.</p>
<p>If called without an explicit login-url, then the default on Nuvla is used.</p>
<p><strong>FIXME</strong>: Ideally the login-url should be discovered from the cloud entry point.</p></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L108">view source</a></div></div><div class="public anchor" id="var-login-resource"><h3>login-resource</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L64">view source</a></div></div><div class="public anchor" id="var-logout-async-with-status"><h3>logout-async-with-status</h3><div class="usage"><code>(logout-async-with-status)</code><code>(logout-async-with-status logout-url)</code></div><div class="doc"><div class="markdown"><p>Removes cached credentials and tokens from the http client.</p></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L134">view source</a></div></div><div class="public anchor" id="var-result-tuple"><h3>result-tuple</h3><div class="usage"><code>(result-tuple result)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L98">view source</a></div></div><div class="public anchor" id="var-select-context"><h3>select-context</h3><div class="usage"><code>(select-context context)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L79">view source</a></div></div><div class="public anchor" id="var-set-context.21"><h3>set-context!</h3><div class="usage"><code>(set-context! context)</code></div><div class="doc"><div class="markdown"><p>Should be called to provide service URL and connection token. The following map is expected</p>
<pre><code>{:serviceurl "https://nuv.la"
 :cookie     "cookie"}
</code></pre></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L85">view source</a></div></div><div class="public anchor" id="var-to-login-url"><h3>to-login-url</h3><div class="usage"><code>(to-login-url service-url)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L66">view source</a></div></div><div class="public anchor" id="var-with-context"><h3>with-context</h3><h4 class="type">macro</h4><div class="usage"><code>(with-context context &amp; body)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L94">view source</a></div></div></div></body></html>