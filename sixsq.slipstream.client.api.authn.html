<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>sixsq.slipstream.client.api.authn documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">com.sixsq.slipstream/SlipStreamClientAPI-jar</span> <span class="project-version">3.4-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="intro.html"><div class="inner"><span>SlipStream Clojure Client API</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sixsq</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>slipstream</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>client</span></div></div></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></div></li><li class="depth-5 branch current"><a href="sixsq.slipstream.client.api.authn.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>authn</span></div></a></li><li class="depth-5 branch"><a href="sixsq.slipstream.client.api.cimi.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cimi</span></div></a></li><li class="depth-5"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></div></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.impl.cimi.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cimi</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.impl.crud.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>crud</span></div></a></li><li class="depth-6"><a href="sixsq.slipstream.client.api.impl.run.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>run</span></div></a></li><li class="depth-5"><div class="no-link"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>lib</span></div></div></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.lib.app.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>app</span></div></a></li><li class="depth-6"><a href="sixsq.slipstream.client.api.lib.run.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>run</span></div></a></li><li class="depth-5 branch"><a href="sixsq.slipstream.client.api.run.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>run</span></div></a></li><li class="depth-5"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></div></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.context.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>context</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.http.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.http-async.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http-async</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.path.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>path</span></div></a></li><li class="depth-6 branch"><a href="sixsq.slipstream.client.api.utils.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li><li class="depth-6"><a href="sixsq.slipstream.client.api.utils.wait.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>wait</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-*context*"><div class="inner"><span>*context*</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-default-context"><div class="inner"><span>default-context</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-default-login-url"><div class="inner"><span>default-login-url</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-default-url"><div class="inner"><span>default-url</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-endpoint-from-url"><div class="inner"><span>endpoint-from-url</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-login"><div class="inner"><span>login</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-login.21"><div class="inner"><span>login!</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-login-async"><div class="inner"><span>login-async</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-login-resource"><div class="inner"><span>login-resource</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-select-context"><div class="inner"><span>select-context</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-set-context.21"><div class="inner"><span>set-context!</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-to-login-url"><div class="inner"><span>to-login-url</span></div></a></li><li class="depth-1"><a href="sixsq.slipstream.client.api.authn.html#var-with-context"><div class="inner"><span>with-context</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">sixsq.slipstream.client.api.authn</h1><div class="doc"><div class="markdown"><p>Provides a utility to log into the SlipStream server and to recover an access token. No logout function is provided as the access can be removed by just destroying the token.</p>
<p>The library API functions in namespaces under <strong>sixsq.slipstream.client.api.lib</strong> use dynamic context defined in this namespace. To bootstrap the API with the context use <a href="sixsq.slipstream.client.api.authn.html#var-login.21">login!</a>. Each time when called, it alters the root of the context with the new authentication token obtained after performing basic authn with the username/password provided to <a href="sixsq.slipstream.client.api.authn.html#var-login.21">login!</a>.</p>
<p><code>(with-context new-context (api-function ...))</code> can be used to rebind the global context to the new provided one for the time of the invocation of a specific API function. The new context can, for example, be obtained by</p>
<pre><code>{:serviceurl "https://my.slipstream"
 :cookie (login username password)}
</code></pre>
<p>Full example</p>
<pre><code>(require '[sixsq.slipstream.client.api.authn :as a])
(require '[sixsq.slipstream.client.api.lib.app :as p])
(require '[sixsq.slipstream.client.api.lib.run :as r])

(def my-slipstream
  {:serviceurl "https://my.slipstream"
   :cookie (a/login username password)}

(def run-uuid
  (last
    (clojure.string/split
      (with-context my-slipstream (p/deploy "my/app")))))

(with-context my-slipstream
  (r/get-run-info run-uuid))
</code></pre></div></div><div class="public anchor" id="var-*context*"><h3>*context*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L64">view source</a></div></div><div class="public anchor" id="var-default-context"><h3>default-context</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L62">view source</a></div></div><div class="public anchor" id="var-default-login-url"><h3>default-login-url</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L58">view source</a></div></div><div class="public anchor" id="var-default-url"><h3>default-url</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L50">view source</a></div></div><div class="public anchor" id="var-endpoint-from-url"><h3>endpoint-from-url</h3><div class="usage"><code>(endpoint-from-url url)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L118">view source</a></div></div><div class="public anchor" id="var-login"><h3>login</h3><div class="usage"><code>(login username password)</code><code>(login username password login-url)</code></div><div class="doc"><pre class="plaintext">Synchronous login to the server.  Directly returns the access token.
Not available in clojurescript.</pre></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L109">view source</a></div></div><div class="public anchor" id="var-login.21"><h3>login!</h3><div class="usage"><code>(login! username password)</code><code>(login! username password login-url)</code></div><div class="doc"><div class="markdown"><p>Synchronous login to the server. Alters the root of the global dynamic authentication context used in the namespaces under <strong>sixsq.slipstream.client.api.lib</strong> to interact with the service. Returns the access token. Not available in clojurescript.</p></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L126">view source</a></div></div><div class="public anchor" id="var-login-async"><h3>login-async</h3><div class="usage"><code>(login-async username password)</code><code>(login-async username password login-url)</code></div><div class="doc"><div class="markdown"><p>Uses the given username and password to log into the SlipStream server. Returns the token (cookie) to be used in subsequent requests. If called without an explicit login-url, then the default on Nuvla is used.</p>
<p>This method returns a channel that will contain the result.</p>
<p><strong>FIXME</strong>: Ideally the login-url should be discovered from the cloud entry point. This requires that the cloud entry point be accessible without credentials.</p></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L87">view source</a></div></div><div class="public anchor" id="var-login-resource"><h3>login-resource</h3><div class="usage"></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L52">view source</a></div></div><div class="public anchor" id="var-select-context"><h3>select-context</h3><div class="usage"><code>(select-context context)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L66">view source</a></div></div><div class="public anchor" id="var-set-context.21"><h3>set-context!</h3><div class="usage"><code>(set-context! context)</code></div><div class="doc"><div class="markdown"><p>Should be called to provide service URL and connection token. The following map is expected</p>
<pre><code>{:serviceurl "https://nuv.la"
 :cookie     "cookie"}
</code></pre></div></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L72">view source</a></div></div><div class="public anchor" id="var-to-login-url"><h3>to-login-url</h3><div class="usage"><code>(to-login-url service-url)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L54">view source</a></div></div><div class="public anchor" id="var-with-context"><h3>with-context</h3><h4 class="type">macro</h4><div class="usage"><code>(with-context context &amp; body)</code></div><div class="doc"><pre class="plaintext"></pre></div><div class="src-link"><a href="https://github.com/slipstream/SlipStreamClientAPI/blob/master/jar/src/cljc/sixsq/slipstream/client/api/authn.cljc#L82">view source</a></div></div></div></body></html>